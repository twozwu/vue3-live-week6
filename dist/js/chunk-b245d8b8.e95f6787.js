(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b245d8b8"],{b0c0:function(t,e,a){var s=a("83ab"),c=a("9bf2").f,l=Function.prototype,n=l.toString,r=/^\s*function ([^ (]*)/,o="name";s&&!(o in l)&&c(l,o,{configurable:!0,get:function(){try{return n.call(this).match(r)[1]}catch(t){return""}}})},b789:function(t,e,a){"use strict";a.r(e);a("b0c0");var s=a("7a23"),c={ref:"cart",class:"container"},l={class:"text-end mt-5"},n=Object(s["f"])("清空購物車 "),r={class:"table align-middle"},o=Object(s["g"])("thead",null,[Object(s["g"])("tr",null,[Object(s["g"])("th"),Object(s["g"])("th",null,"品名"),Object(s["g"])("th",{style:{width:"150px"}},"數量/單位"),Object(s["g"])("th",{class:"text-end"},"單價")])],-1),i=Object(s["f"])(" x "),d={key:0,class:"text-success"},u={class:"input-group input-group-sm"},b={class:"input-group mb-3"},m={class:"input-group-text",id:"basic-addon2"},g={class:"text-end"},f={class:"text-success"},O={key:0},j=Object(s["g"])("td",{colspan:"3",class:"text-end"},"總計",-1),p={class:"text-end"},h=Object(s["g"])("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),v={class:"text-end text-success"},x={key:0,class:"text-center"},y=Object(s["g"])("p",null,"購物車為空",-1),S={class:"my-5 row justify-content-center"},k={class:"mb-3"},C=Object(s["g"])("label",{for:"email",class:"form-label"},"Email",-1),V={class:"mb-3"},U=Object(s["g"])("label",{for:"name",class:"form-label"},"收件人姓名",-1),w={class:"mb-3"},q=Object(s["g"])("label",{for:"tel",class:"form-label"},"收件人電話",-1),A={class:"mb-3"},E=Object(s["g"])("label",{for:"address",class:"form-label"},"收件人地址",-1),L={class:"mb-3"},P=Object(s["g"])("label",{for:"message",class:"form-label"},"留言",-1),F={class:"text-end"},I=Object(s["f"])("送出訂單 ");function _(t,e,a,_,B,G){var J=Object(s["x"])("font-awesome-icon"),D=Object(s["x"])("Field"),H=Object(s["x"])("ErrorMessage"),M=Object(s["x"])("Form");return Object(s["s"])(),Object(s["d"])("div",c,[Object(s["g"])("div",l,[Object(s["g"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[1]||(e[1]=function(){return G.clearCart&&G.clearCart.apply(G,arguments)}),disabled:!B.cartsLength},["clear"==B.loadingStatus?(Object(s["s"])(),Object(s["d"])(J,{key:0,icon:"spinner",pulse:"",class:"fas fa-spinner fa-pulse"})):Object(s["e"])("",!0),n],8,["disabled"])]),Object(s["g"])("table",r,[o,Object(s["g"])("tbody",null,[0!=B.carts.carts?(Object(s["s"])(!0),Object(s["d"])(s["a"],{key:0},Object(s["w"])(B.carts.carts,(function(t){return Object(s["s"])(),Object(s["d"])("tr",{key:t.id},[Object(s["g"])("td",null,[Object(s["g"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return G.delItem(t.id)}},[B.loadingStatus==t.id?(Object(s["s"])(),Object(s["d"])(J,{key:0,icon:"spinner",pulse:"",class:"fas fa-spinner fa-pulse"})):Object(s["e"])("",!0),i],8,["onClick"])]),Object(s["g"])("td",null,[Object(s["f"])(Object(s["A"])(t.product.title)+" ",1),t.coupon?(Object(s["s"])(),Object(s["d"])("div",d," 已套用優惠券 ")):Object(s["e"])("",!0)]),Object(s["g"])("td",null,[Object(s["g"])("div",u,[Object(s["g"])("div",b,[Object(s["I"])(Object(s["g"])("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":function(e){return t.qty=e},disabled:B.loadingStatus==t.id,onBlur:function(e){return G.updateCart(t)}},null,40,["onUpdate:modelValue","disabled","onBlur"]),[[s["E"],t.qty,void 0,{number:!0}]]),Object(s["g"])("span",m,Object(s["A"])(t.product.unit),1)])])]),Object(s["g"])("td",g,[Object(s["g"])("small",f,"折扣價："+Object(s["A"])(t.product.price),1)])])})),128)):Object(s["e"])("",!0)]),0!=B.carts.total?(Object(s["s"])(),Object(s["d"])("tfoot",O,[Object(s["g"])("tr",null,[j,Object(s["g"])("td",p,Object(s["A"])(B.carts.total),1)]),Object(s["g"])("tr",null,[h,Object(s["g"])("td",v,Object(s["A"])(B.carts.final_total),1)])])):Object(s["e"])("",!0)]),0==B.carts.total?(Object(s["s"])(),Object(s["d"])("div",x,[y])):Object(s["e"])("",!0),Object(s["g"])("div",S,[Object(s["g"])(M,{ref:"form",class:"col-md-6",onSubmit:G.createOrder},{default:Object(s["H"])((function(t){var a=t.errors;return[Object(s["g"])("div",k,[C,Object(s["g"])(D,{id:"email",name:"email",type:"email",class:["form-control",{"is-invalid":a["email"]}],placeholder:"請輸入 Email",rules:"email|required",modelValue:B.form.user.email,"onUpdate:modelValue":e[2]||(e[2]=function(t){return B.form.user.email=t})},null,8,["class","modelValue"]),Object(s["g"])(H,{name:"email",class:"invalid-feedback"})]),Object(s["g"])("div",V,[U,Object(s["g"])(D,{id:"name",name:"姓名",type:"text",class:["form-control",{"is-invalid":a["姓名"]}],placeholder:"請輸入姓名",rules:"required",modelValue:B.form.user.name,"onUpdate:modelValue":e[3]||(e[3]=function(t){return B.form.user.name=t})},null,8,["class","modelValue"]),Object(s["g"])(H,{name:"姓名",class:"invalid-feedback"})]),Object(s["g"])("div",w,[q,Object(s["g"])(D,{id:"tel",name:"電話",type:"tel",class:["form-control",{"is-invalid":a["電話"]}],placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:B.form.user.tel,"onUpdate:modelValue":e[4]||(e[4]=function(t){return B.form.user.tel=t})},null,8,["class","modelValue"]),Object(s["g"])(H,{name:"電話",class:"invalid-feedback"})]),Object(s["g"])("div",A,[E,Object(s["g"])(D,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":a["地址"]}],placeholder:"請輸入地址",rules:"required",modelValue:B.form.user.address,"onUpdate:modelValue":e[5]||(e[5]=function(t){return B.form.user.address=t})},null,8,["class","modelValue"]),Object(s["g"])(H,{name:"地址",class:"invalid-feedback"})]),Object(s["g"])("div",L,[P,Object(s["I"])(Object(s["g"])("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[6]||(e[6]=function(t){return B.form.message=t})},null,512),[[s["E"],B.form.message]])]),Object(s["g"])("div",F,[Object(s["g"])("button",{type:"submit",class:"btn btn-danger",disabled:!B.cartsLength},["submit"==B.loadingStatus?(Object(s["s"])(),Object(s["d"])(J,{key:0,icon:"spinner",pulse:"",class:"fas fa-spinner fa-pulse"})):Object(s["e"])("",!0),I],8,["disabled"])])]})),_:1},8,["onSubmit"])])],512)}a("99af");var B={data:function(){return{apiUrl:"https://vue3-course-api.hexschool.io",apiPath:"onedog",carts:{},qty:1,loadingStatus:"",cartsLength:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart:function(){this.emitter.emit("navGetCart")},updateCart:function(t){var e=this;this.loadingStatus=t.id;var a={product_id:t.product_id,qty:t.qty},s="".concat(this.apiUrl,"/api/").concat(this.apiPath,"/cart/").concat(t.id);this.axios.put(s,{data:a}).then((function(t){t.data.success?(alert(t.data.message),e.loadingStatus="",e.getCart()):(alert(t.data.message),e.loadingStatus="")})).catch((function(t){return console.log(t)}))},clearCart:function(){var t=this;this.loadingStatus="clear";var e="".concat(this.apiUrl,"/api/").concat(this.apiPath,"/carts");this.axios.delete(e).then((function(e){e.data.success?(alert(e.data.message),t.getCart(),t.loadingStatus=""):(alert(e.data.message),t.loadingStatus="")})).catch((function(t){return console.log(t)}))},delItem:function(t){var e=this;this.loadingStatus=t;var a="".concat(this.apiUrl,"/api/").concat(this.apiPath,"/cart/").concat(t);this.axios.delete(a).then((function(t){t.data.success?(alert(t.data.message),e.loadingStatus="",e.getCart()):(alert(t.data.message),e.loadingStatus="")})).catch((function(t){return console.log(t)}))},createOrder:function(){var t=this;if(this.loadingStatus="submit",this.cartsLength<=0)alert("購物車為空，請下單完再送出唷");else{var e="".concat(this.apiUrl,"/api/").concat(this.apiPath,"/order"),a=this.form;this.axios.post(e,{data:a}).then((function(e){e.data.success?(alert("".concat(e.data.message,"，謝謝惠顧。")),t.$refs.form.resetForm(),t.loadingStatus="",t.getCart()):alert(e.data.message)})).catch((function(t){return console.log(t)}))}}},created:function(){var t=this;this.emitter.on("cartsGetData",(function(e){e&&(t.carts=e,t.cartsLength=e.carts.length)}))},mounted:function(){this.getCart()}};B.render=_;e["default"]=B}}]);
//# sourceMappingURL=chunk-b245d8b8.e95f6787.js.map